<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>consult summary</title>
  <style>
    /* Ensure the body fills the viewport */
    html, body {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: white;
    }

    /* Prevent landscape mode */
    @media screen and (orientation: landscape) {
      body {
        display: none;
      }
    }

    /* Fixed Header */
    .header {
      width: 100%;
      text-align: center;
      font-size: 7vw;
      font-weight: bold;
      font-family: "Courier New", Courier, monospace;
      color: white;
      background-color: rgba(0, 0, 0, 0.2);
      z-index: 1000;
      padding-top: 5px;
      padding-bottom: 10px;
    }

    /* ✅ Main Container */
    .content-container {
      position: relative;
      width: 35%;
      max-width: 165px;
      height: auto;
      min-height: 175px;
      background-color: white;
      border: 6px solid black; /* Default (overridden to pink if age=2..15) */
      border-radius: 8px;
      margin-top: 5px;
      margin-left: -190px;
      padding: 20px;
      text-align: center;
    }

    /* ✅ Consult Image */
    #consultImage {
      width: 100%;
      max-width: 400px;
      display: block;
      margin: 0 auto;
    }

    /* ✅ Positioning & Styling for Input Fields */
    .input-field {
      position: absolute;
      width: 40px;
      height: 20px;
      background: white;
      border: 2px solid black;
      text-align: center;
      font-size: 12px;
      font-weight: bold;
      color: black;
      cursor: default;
      user-select: none;
      pointer-events: none;
      z-index: 10;
    }

    /* ✅ TBSA Total Box */
    .field8 { 
      width: 80px;
      height: 25px;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
    }

    /* ✅ Input Field Positions (Modify Manually) */
    .field1 { top: 35px;  left: 62px; }
    .field2 { top: 90px;  left: 61px; }
    .field3 { top: 155px; left: 63px; }
    .field4 { top: 114px; left: 18px; }
    .field5 { top: 114px; left: 106px; }
    .field6 { top: 215px; left: 45px; }
    .field7 { top: 215px; left: 88px; }

    /* ✅ Navigation Buttons */
    .nav-buttons {
      position: absolute;
      bottom: 13px;
      display: flex;
      width: 60vw;
      max-width: 400px;
      justify-content: center;
      align-items: center;
      gap: 100px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
    }
    .nav-buttons img {
      width: 100px;
      height: 75px;
      cursor: pointer;
      border-radius: 10px;
      opacity: 0.9;
      transition: transform 0.2s ease;
    }
    .nav-buttons img:active {
      transform: scale(1.1);
    }

    /* ✅ Step Buttons Container */
    .step-buttons {
      position: absolute;
      top: 100px;
      left: 225px;
      display: flex;
      flex-direction: column;
      gap: 25px;
      z-index: 1000;
    }
    .step-button {
      position: relative;
      width: 100px;
      height: 50px;
      font-size: 16px;
      font-weight: bold;
      color: white;
      border: none;
      cursor: pointer;
      text-transform: uppercase;
      user-select: none;
      transition: all 0.2s ease-in-out;
      transform: skewX(0deg);
      background: linear-gradient(145deg, #4A90E2, #1E5799);
      box-shadow: -3px 3px 6px rgba(0, 0, 0, 0.4), 3px -3px 6px rgba(255, 255, 255, 0.3);
      border-radius: 8px;
    }
    .step-button:hover {
      background: linear-gradient(145deg, #1E5799, #4A90E2);
      transform: skewX(-15deg) scale(1.05);
    }
    .step-button:active {
      background: linear-gradient(145deg, #003366, #1E5799);
      box-shadow: inset -2px 2px 5px rgba(0, 0, 0, 0.5), inset 2px -2px 5px rgba(255, 255, 255, 0.2);
    }

    /* ✅ Main Adjustable Container */
    .adjustable-container {
      position: absolute;
      width: 75%;
      height: 69%;
      max-width: 300px;
      max-height: 140px;
      top: 400px;
      left: 25px;

      background-color: white;
      border: 3px solid black;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    .adjustable-container .container-header {
      width: 100%;
      padding: 10px 0;
      font-size: 16px;
      font-family: "Courier New", Courier, monospace;
      font-weight: bold;
      color: white;
      background-color: #0047AB;
      border-bottom: 0px solid black;
      border-radius: 0px 0px 0 0;
      user-select: none;
      margin-top: -15px;
      margin-bottom: 5px;
    }

    /* ✅ Step 1 Popup */
    .step1-popup {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 85%;
      max-width: 500px;
      background: rgba(255, 255, 255, 1);
      border: 5px solid black;
      border-radius: 10px;
      padding: 20px;
      font-family: "Courier New", Courier, monospace;
      font-size: 18px;
      font-weight: bold;
      color: black;
      box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.5);
      z-index: 10000;
      display: none;
      flex-direction: column;
      justify-content: space-between;
      align-items: flex-start;
    }
    .step1-popup p {
      text-align: left;
      margin-bottom: 10px;
      line-height: 1.4;
    }
    .step1-popup label {
      display: block;
      margin: 4px 0 10px 20px;
      font-size: 18px;
    }
    .step1-popup input[type="radio"] {
      transform: scale(1.3);
      margin-right: 8px;
    }
    .step1-popup .close-popup {
      width: 60%;
      max-width: 200px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: bold;
      background: red;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
      transition: all 0.2s ease-in-out;
      margin-top: 20px;
      margin-bottom: 15px;
      align-self: center;
    }
    .step1-popup .close-popup:hover {
      background: darkred;
    }
    .step1-popup .close-popup:active {
      transform: scale(0.95);
    }

    /* ✅ Step 2 Popup */
    .step2-popup {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 85%;
      max-width: 500px;
      background: rgba(255, 255, 255, 1);
      border: 5px solid black;
      border-radius: 10px;
      padding: 20px;
      font-family: "Courier New", Courier, monospace;
      font-size: 18px;
      font-weight: bold;
      color: black;
      box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.5);
      z-index: 10000;
      display: none;
      flex-direction: column;
      justify-content: space-between;
      align-items: flex-start;
    }
    .step2-popup p {
      text-align: left;
      margin-bottom: 10px;
      line-height: 1.4;
    }
    .step2-popup label {
      display: block;
      margin: 4px 0 10px 20px;
      font-size: 18px;
    }
    .step2-popup input[type="radio"] {
      transform: scale(1.3);
      margin-right: 8px;
    }
    .step2-popup .close-popup {
      width: 60%;
      max-width: 200px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: bold;
      background: red;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
      transition: all 0.2s ease-in-out;
      margin-top: 20px;
      margin-bottom: 15px;
      align-self: center;
    }
    .step2-popup .close-popup:hover {
      background: darkred;
    }
    .step2-popup .close-popup:active {
      transform: scale(0.95);
    }

    /* ✅ Step 3 Popup */
    .step3-popup {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 85%;
      max-width: 500px;
      background: rgba(255, 255, 255, 1);
      border: 5px solid black;
      border-radius: 10px;
      padding: 20px;
      font-family: "Courier New", Courier, monospace;
      font-size: 18px;
      font-weight: bold;
      color: black;
      box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.5);
      z-index: 10000;
      display: none;
      flex-direction: column;
      justify-content: space-between;
      align-items: flex-start;
    }
    .step3-popup p {
      text-align: left;
      margin-bottom: 10px;
      line-height: 1.4;
    }
    .step3-popup label {
      display: block;
      margin: 4px 0 10px 20px;
      font-size: 18px;
    }
    .step3-popup input[type="radio"] {
      transform: scale(1.3);
      margin-right: 8px;
    }
    .step3-popup .close-popup {
      width: 60%;
      max-width: 200px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: bold;
      background: red;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
      transition: all 0.2s ease-in-out;
      margin-top: 20px;
      margin-bottom: 15px;
      align-self: center;
    }
    .step3-popup .close-popup:hover {
      background: darkred;
    }
    .step3-popup .close-popup:active {
      transform: scale(0.95);
    }

    /* ✅ Step 4 Popup */
    .step4-popup {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 85%;
      max-width: 500px;
      background: rgba(255, 255, 255, 1);
      border: 5px solid black;
      border-radius: 10px;
      padding: 20px;
      font-family: "Courier New", Courier, monospace;
      font-size: 14px;
      font-weight: bold;
      color: black;
      box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.5);
      z-index: 10000;
      display: none;
      flex-direction: column;
      justify-content: space-between;
      align-items: flex-start;
    }
    .step4-popup .checkbox-container {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 5px;
    }
    .step4-popup input[type="checkbox"] {
      margin-top: 3px;
      transform: scale(1.3);
    }
    .step4-popup label {
      display: flex;
      flex: 1;
      text-align: left;
      line-height: 1.4;
    }
    .step4-popup .close-popup {
      width: 60%;
      max-width: 200px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: bold;
      background: red;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
      transition: all 0.2s ease-in-out;
      margin-top: 20px;
      margin-bottom: 15px;
      align-self: center;
    }
    .step4-popup .close-popup:hover {
      background: darkred;
    }
    .step4-popup .close-popup:active {
      transform: scale(0.95);
    }

    /* ✅ Step Item - Keeps Step # and Status Inline */
    .step-item {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 2px;
      white-space: nowrap;
    }
    .step-status {
      margin-left: 10px;
      font-size: 18px;
      font-weight: bold;
      color: red;
    }
  </style>
</head>
<body>
<!-- Fixed Header (now controlled by JavaScript) -->
<div class="header"></div>

<!-- Main Container -->
<div class="content-container">
    <!-- Consult Image -->
    <img id="consultImage" src="https://raw.githubusercontent.com/concussed8/Android-App/main/images/consult_tbsa.png" alt="Consult TBSA Image">

    <!-- Input Fields Positioned Over Image -->
    <input type="text" class="input-field field1" value="0">
    <input type="text" class="input-field field2" value="0">
    <input type="text" class="input-field field3" value="0">
    <input type="text" class="input-field field4" value="0">
    <input type="text" class="input-field field5" value="0">
    <input type="text" class="input-field field6" value="0">
    <input type="text" class="input-field field7" value="0">
    
    <!-- TBSA Total Box -->
    <input type="text" class="input-field field8" readonly value="0%">
</div>

<!-- ✅ Step Buttons Container -->
<div class="step-buttons">
    <button class="step-button" id="step1">Step 1</button>
    <button class="step-button" id="step2">Step 2</button>
    <button class="step-button" id="step3">Step 3</button>
    <button class="step-button" id="step4">Step 4</button>
</div>

<!-- ✅ Step 1 Popup -->
<div id="stepPopup1" class="step1-popup">
    <p>Does your patient have any % of FULL thickness burns?</p>
    <label>
        <input type="radio" name="fullThickness" value="yes" />
        Yes
    </label>
    <label>
        <input type="radio" name="fullThickness" value="no" />
        No
    </label>

    <p>Does your patient have PARTIAL thickness burns ≥ 10% TBSA?</p>
    <label>
        <input type="radio" name="partialThickness" value="yes" />
        Yes
    </label>
    <label>
        <input type="radio" name="partialThickness" value="no" />
        No
    </label>

    <!-- Step 1 has a special close function requiring both questions are answered -->
    <button class="close-popup" onclick="closeStep1Popup()">CLOSE</button>
</div>

<!-- ✅ Step 2 Popup -->
<div id="stepPopup2" class="step2-popup">
    <p>Does your patient have any deep PARTIAL or FULL thickness burns involving the FACE, HANDS, GENITALIA, FEET, PERINEUM or over any JOINT?</p>
    <label>
        <input type="radio" name="sensitive" value="yes" />
        Yes
    </label>
    <label>
        <input type="radio" name="sensitive" value="no" />
        No
    </label>

    <button class="close-popup" onclick="closePopup('stepPopup2', 2)">CLOSE</button>
</div>

<!-- ✅ Step 3 Popup -->
<div id="stepPopup3" class="step3-popup">
    <p>Does your patient have INHALATION injury with any % of deep PARTIAL or FULL thickness burns?</p>
    <label>
        <input type="radio" name="inhalation" value="yes" />
        Yes
    </label>
    <label>
        <input type="radio" name="inhalation" value="no" />
        No
    </label>

    <button class="close-popup" onclick="closePopup('stepPopup3', 3)">CLOSE</button>
</div>

<!-- ✅ Step 4 Popup (Multiple Checkboxes Allowed) -->
<div id="stepPopup4" class="step4-popup">
    <p>Does your patient have any of the following HIGH-RISK CONSIDERATIONS?</p>

    <div class="checkbox-container">
        <input type="checkbox" name="highRisk" value="age" />
        <label>≥ 50 years of age</label>
    </div>
    <div class="checkbox-container">
        <input type="checkbox" name="highRisk" value="anticoagulated" />
        <label>Anticoagulated</label>
    </div>
    <div class="checkbox-container">
        <input type="checkbox" name="highRisk" value="immunosuppressed" />
        <label>Immunosuppression</label>
    </div>
    <div class="checkbox-container">
        <input type="checkbox" name="highRisk" value="pregnancy" />
        <label>Pregnancy</label>
    </div>
    <div class="checkbox-container">
        <input type="checkbox" name="highRisk" value="diabetes" />
        <label>Diabetes</label>
    </div>
    <div class="checkbox-container">
        <input type="checkbox" name="highRisk" value="social_care" />
        <label>Patients with burns requiring special social, emotional, or rehabilitation care</label>
    </div>
    <div class="checkbox-container">
        <input type="checkbox" name="highRisk" value="ed_assessment" />
        <label>Patients requiring more care based on the assessment of the ED physician</label>
    </div>
    <div class="checkbox-container">
        <input type="checkbox" name="highRisk" value="significant_problems" />
        <label>Significant medical problems</label>
    </div>
    <div class="checkbox-container">
        <input type="checkbox" name="highRisk" value="none" />
        <label>None</label>
    </div>

    <button class="close-popup" onclick="closePopup('stepPopup4', 4)">CLOSE</button>
</div>

<!-- ✅ Main Adjustable Container -->
<div class="adjustable-container">
    <!-- ✅ Container Header -->
    <div class="container-header">Consult Checklist Completion</div>

    <!-- ✅ Step Status without Extra Gaps -->
    <div class="step-container">
        <span class="step-item">Step 1: <span id="stepStatus1" class="step-status">PENDING</span></span>
        <span class="step-item">Step 2: <span id="stepStatus2" class="step-status">PENDING</span></span>
        <span class="step-item">Step 3: <span id="stepStatus3" class="step-status">PENDING</span></span>
        <span class="step-item">Step 4: <span id="stepStatus4" class="step-status">PENDING</span></span>
    </div>
</div>

<!-- Next & Prev Buttons -->
<div class="nav-buttons">
    <img src="https://raw.githubusercontent.com/concussed8/Android-App/main/images/prev.png" id="prevBtn" alt="Previous">
    <img src="https://raw.githubusercontent.com/concussed8/Android-App/main/images/next.png" id="nextBtn" alt="Next">
</div>

<script> 
/***********************************************************
 * 1) SESSION COOKIE HELPERS
 ************************************************************/
// ✅ Function: Retrieve a session cookie value
function getSessionCookie(name) {
    let cookies = document.cookie.split('; ');
    for (let cookie of cookies) {
        let [cookieName, cookieValue] = cookie.split('=');
        if (cookieName === name) {
            return decodeURIComponent(cookieValue);
        }
    }
    return "";
}
// ✅ Function: Set a session cookie with expiration
function setSessionCookie(name, value) {
    document.cookie = `${name}=${encodeURIComponent(value)}; path=/; SameSite=Lax; max-age=86400`; // Expires in 1 day
}

/***********************************************************
 * 1b) PINK BORDER IF AGE=2..15
 ************************************************************/
function applyPinkBorderIfAge2to15() {
    let age = parseInt(getSessionCookie("age"), 10);
    let container = document.querySelector(".content-container");
    if (!container) return; // If not found, do nothing

    if (!isNaN(age) && age >= 2 && age <= 15) {
        console.log("✅ Age is 2..15 => Pink border");
        container.style.border = "3px solid #ffc0cb";
    } else {
        console.log("✅ Age not 2..15 => Black border");
        container.style.border = "3px solid black";
    }
}

/***********************************************************
 * 2) BACKGROUND + HEADER TITLE
 ************************************************************/
// ✅ Function: Update Background Color Based on Burn Type
function updateBackgroundColor() {
    setTimeout(() => {
        let burnType = getSessionCookie("selectedIcon") || "thermal";
        let colors = {
            "thermal": "#800000",
            "chemical": "#90EE90",
            "electrical": "#ADD8E6"
        };
        if (colors[burnType]) {
            document.body.style.backgroundColor = colors[burnType];
        }
    }, 200);
}

// ✅ Function: Update Header Title Dynamically
function updateHeaderTitle() {
    let selectedIcon = getSessionCookie("selectedIcon");
    let headerElement = document.querySelector(".header");
    if (headerElement) {
        headerElement.innerHTML = selectedIcon
            ? `<u>${selectedIcon.toUpperCase()} BURN</u><br> Consult Summary`
            : "<u>THERMAL BURN</u><br> Consult Checklist";
    }
}

/***********************************************************
 * 3) TBSA FIELDS
 ************************************************************/
// ✅ Function: Populate Input Fields from Cookies & Calculate TBSA Total
function populateFieldsFromCookies() {
    let storedTBSA = getSessionCookie("adultTBSA");
    let totalTBSA = 0;
    if (storedTBSA) {
        try {
            let tbsaData = JSON.parse(storedTBSA);
            for (let i = 1; i <= 7; i++) {
                let fieldName = `field${i}`;
                let inputField = document.querySelector(`.input-field.${fieldName}`);
                if (inputField) {
                    let value = tbsaData[fieldName] || "0%";
                    inputField.value = value;
                    inputField.readOnly = true;
                    totalTBSA += parseFloat(value.replace("%", "")) || 0;
                }
            }
            let totalField = document.querySelector(".input-field.field8");
            if (totalField) {
                totalField.value = totalTBSA.toFixed(1) + "%";
                totalField.readOnly = true;
            }
        } catch (error) {
            console.error("❌ Error parsing TBSA cookie:", error);
        }
    } else {
        console.warn("⚠️ No TBSA data found in cookies.");
    }
}

/***********************************************************
 * 4) POPUP CONTROL
 ************************************************************/
// ✅ Function: Open a step popup
function openPopup(stepId) {
    document.getElementById(stepId).style.display = "block";
}

// ✅ Function: Close Step 1 Popup (Requires Answers for Both Questions)
function closeStep1Popup() {
    let fullThicknessChecked = document.querySelector('input[name="fullThickness"]:checked');
    let partialThicknessChecked = document.querySelector('input[name="partialThickness"]:checked');
    if (!fullThicknessChecked || !partialThicknessChecked) {
        alert("❌ You must select an answer for both questions before proceeding.");
        return;
    }
    closePopup("stepPopup1", 1);
}

// ✅ Function: Close a step popup, save responses, and mark completion
function closePopup(stepId, stepNumber) {
    saveStepResponses(stepId);
    updateStepStatus(stepNumber);
    document.getElementById(stepId).style.display = "none";
}

/***********************************************************
 * 5) RADIO / CHECKBOX SAVING & RESTORING
 ************************************************************/
// ✅ Function: Save Radio + Checkbox State for a Given Step
function saveStepResponses(stepId) {
    let inputs = document.querySelectorAll(`#${stepId} input[type="radio"], #${stepId} input[type="checkbox"]`);
    let stepData = {};
    inputs.forEach(input => {
        if (input.type === "radio") {
            if (input.checked) {
                stepData[input.name] = input.value;
            }
        } else if (input.type === "checkbox") {
            stepData[input.name] = input.checked ? "checked" : "unchecked";
        }
    });
    setSessionCookie(stepId, JSON.stringify(stepData));
}

// ✅ Function: Restore Radio + Checkbox State for a Given Step
function restoreStepResponses(stepId) {
    let storedData = getSessionCookie(stepId);
    if (storedData) {
        let stepData = JSON.parse(storedData);
        let inputs = document.querySelectorAll(`#${stepId} input[type="radio"], #${stepId} input[type="checkbox"]`);
        inputs.forEach(input => {
            if (input.type === "radio") {
                if (stepData[input.name] === input.value) {
                    input.checked = true;
                }
            } else if (input.type === "checkbox") {
                if (stepData[input.name] === "checked") {
                    input.checked = true;
                }
            }
        });
    }
}

/***********************************************************
 * 6) STEP STATUS + NAVIGATION
 ************************************************************/
// ✅ Function: Mark Step as "COMPLETED" or "PENDING"
function updateStepStatus(stepNumber) {
    let stepElement = document.getElementById(`stepStatus${stepNumber}`);
    let inputs = document.querySelectorAll(`#stepPopup${stepNumber} input[type="radio"], #stepPopup${stepNumber} input[type="checkbox"]`);
    let isCompleted = Array.from(inputs).some(input => input.checked);
    if (stepElement) {
        stepElement.innerText = isCompleted ? "COMPLETED" : "PENDING";
        stepElement.style.color = isCompleted ? "darkgreen" : "red";
        stepElement.style.fontWeight = "bold";
    }
    enableNextButton();
}

// ✅ Function: Disable Next Button Initially
function disableNextButton() {
    let nextBtn = document.getElementById("nextBtn");
    if (nextBtn) {
        nextBtn.style.pointerEvents = "none";
        nextBtn.style.opacity = "0.5";
    }
}

// ✅ Function: Enable Next Button Only If All Steps Are Completed
function enableNextButton() {
    let nextBtn = document.getElementById("nextBtn");
    if (!nextBtn) return;
    let allCompleted = true;
    for (let i = 1; i <= 4; i++) {
        let stepStatus = document.getElementById(`stepStatus${i}`);
        if (!stepStatus || stepStatus.innerText !== "COMPLETED") {
            allCompleted = false;
            break;
        }
    }
    if (allCompleted) {
        nextBtn.style.pointerEvents = "auto";
        nextBtn.style.opacity = "1";
    } else {
        nextBtn.style.pointerEvents = "none";
        nextBtn.style.opacity = "0.5";
    }
}

/***********************************************************
 * 7) PREV / NEXT BUTTONS
 ************************************************************/
// ✅ Function: Handle Previous Button Click
function setupPreviousButton() {
    let prevBtn = document.getElementById("prevBtn");
    if (prevBtn) {
        prevBtn.addEventListener("click", function () {
            let burnType = getSessionCookie("selectedIcon"); 
            if (burnType === "electrical") {
                window.location.href = "https://concussed8.github.io/Android-App/pages/voltage/1000_volts.html";
            } else {
                window.location.href = "https://concussed8.github.io/Android-App/pages/modified_parkland/parkland.html";
            }
        });
    }
}

// ✅ Function: Handle Next Button Click
function setupNextButton() {
    let nextBtn = document.getElementById("nextBtn");
    if (nextBtn) {
        nextBtn.addEventListener("click", function () {
            window.location.href = "https://concussed8.github.io/Android-App/pages/modified_parkland/parkland.html";
        });
    }
}

/***********************************************************
 * 8) EVENT LISTENERS ON BUTTONS
 ************************************************************/
document.getElementById("step1").addEventListener("click", function () {
    openPopup("stepPopup1");
});
document.getElementById("step2").addEventListener("click", function () {
    openPopup("stepPopup2");
});
document.getElementById("step3").addEventListener("click", function () {
    openPopup("stepPopup3");
});
document.getElementById("step4").addEventListener("click", function () {
    openPopup("stepPopup4");
});

document.querySelector("#stepPopup1 .close-popup").addEventListener("click", closeStep1Popup);
document.querySelector("#stepPopup2 .close-popup").addEventListener("click", function () {
    closePopup("stepPopup2", 2);
});
document.querySelector("#stepPopup3 .close-popup").addEventListener("click", function () {
    closePopup("stepPopup3", 3);
});
document.querySelector("#stepPopup4 .close-popup").addEventListener("click", function () {
    closePopup("stepPopup4", 4);
});

/***********************************************************
 * 9) ON PAGE LOAD
 ************************************************************/
document.addEventListener("DOMContentLoaded", function () {
    // 1) Pink border logic
    applyPinkBorderIfAge2to15();

    // 2) Then do your other dynamic updates
    updateBackgroundColor();
    updateHeaderTitle();
    disableNextButton();
    setupPreviousButton();
    setupNextButton();

    for (let i = 1; i <= 4; i++) {
        restoreStepResponses(`stepPopup${i}`);
        updateStepStatus(i);
    }

    populateFieldsFromCookies();
});

/***********************************************************
 * 10) ORIENTATION CHANGES
 ************************************************************/
window.addEventListener("resize", checkOrientation);
window.addEventListener("orientationchange", checkOrientation);

function checkOrientation() {
    // if(window.innerWidth < window.innerHeight) { ... }
}
</script>
</body>
</html>
