<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Adul_TBSA</title>
  <style>
    /* ==========================
   General Page Styling
   ========================== */

/* Ensures the body fills the viewport and centers content */
body {
  margin: 0; /* Removes default browser margin */
  padding: 0; /* Removes default browser padding */
  display: flex; /* Enables flexible layout */
  flex-direction: column; /* Stacks elements vertically */
  align-items: center; /* Centers elements horizontally */
  justify-content: center; /* Centers elements vertically */
  height: 100vh; /* Full viewport height */
  background-color: #800000; /* Default background color */
  overflow-y: auto; /* Allows scrolling and pull-to-refresh on mobile */
}

/* ==========================
   Simulate Mobile Viewport on Desktop
   ========================== */

/*
@media screen and (min-width: 769px) { 
  body {
    transform: scale(0.7); /* Adjust the scale factor as needed */
    transform-origin: top center; /* Ensures scaling from center */
    width: 375px; /* Approximate mobile width */
    height: 667px; /* Approximate mobile height */
    overflow: hidden; /* Prevents extra scrollbars */
  }
}
*/



/* ==========================
   Prevent Landscape Mode
   ========================== */

/* Hides the entire page when in landscape mode */
@media screen and (orientation: landscape) {
  body {
    display: none; /* Prevents usage in landscape orientation */
  }
}


/* ==========================
   Fixed Header (Main Body, Full Width)
   ========================== */
.header {
  position: relative; /* Keeps header within normal document flow */
  width: 100%; /* Stretches header across the full page width */
  text-align: center; /* Centers text */
  background-color: hsl(350, 100%, 83%); /* Contrasting pink background */
  padding: 12px 0; /* Adds vertical spacing */
  color: white !important;
  font-size: 22px; /* Large text for readability */
  font-weight: bold; /* Bold text */
  font-family: "Courier New", Courier, monospace; /* Monospace font */
  user-select: none; /* Disables text selection */
  z-index: 1000; /* Keeps header above other elements */
  border-bottom: 0px solid black; /* Optional: Adds a bold black bottom border */
margin-bottom: 20px; /* ✅ Creates space between the header and the container */
}




/* ==========================
   Image Container
   ========================== */

/* Wrapper for the burn image */
.image-container {
  position: relative; /* Allows absolute positioning inside */
  width: 90vw; /* Makes image responsive */
  max-width: 488px; /* Prevents excessive stretching */
  aspect-ratio: 488 / 985; /* Maintains image aspect ratio */
  z-index: 1; /* Ensures image stays behind inputs */
}

/* Styles for the burn reference image */
.image-container img {
  width: 100%; /* Ensures full width */
  height: auto; /* Maintains aspect ratio */
  display: block; /* Prevents extra spacing */
  background-color: #ffc0cb; /* ✅ White background applied only within the pink border */
  outline: 6px solid hsl(350, 100%, 83%); /* Adds pink border around the image */
  border-radius: 8px; /* Slightly rounds corners */
}


/* ==========================
   Input Fields (Fillable Areas)
   ========================== */

/* General input field styling */
.input-field {
  position: absolute; /* Allows precise placement */
  width: 16%; /* Relative to image width */
  height: 5%; /* Relative to image height */
  background: white; /* White background */
  border: 6px solid black; /* Thick black border */
  text-align: center; /* Centers text */
  font-size: 1em; /* Readable font size */
  font-weight: bold; /* Bold text */
  color: black; /* Black text */
  cursor: default; /* Prevents cursor changes */
  user-select: none; /* Disables selection */
  z-index: 10; /* Ensures inputs are above the image */
}

/* Highlights input when edited */
.input-field.red-bold {
  color: red; /* Changes text color to red */
  font-weight: bold; /* Makes text bold */
}

/* ==========================
   Input Field Positions (Mapped to Body Parts)
   ========================== */

.field1 { top:25px; left: 70px; }  /* Head (Max 9%) */
.field2 { top: 110px; left: 72px; } /* Chest/Trunk (Max 36%) */
.field3 { top: 208px; left: 73px; } /* Groin (Max 1%) */
.field4 { top: 144px; left:1px; }  /* Right Arm (Max 9%) */
.field5 { top: 144px; left: 140px; } /* Left Arm (Max 9%) */
.field6 { top: 303px; left: 42px; } /* Right Leg (Max 18%) */
.field7 { top: 303px; left: 108px; } /* Left Leg (Max 18%) */

/* ==========================
   Footer (Hidden)
   ========================== */
.footer {
  display: none; /* Hides footer */
}

/* ==========================
   Mobile Adjustments (Small Screens)
   ========================== */
@media (max-width: 768px) {
  .input-field {
    font-size: 0.8em; /* Reduces font size */
    border: 2px solid black; /* Thinner borders */
  }
}

/* ==========================
   Navigation Buttons
   ========================== */

/* Container for navigation buttons */
.nav-buttons {
  position: absolute; /* Ensures it stays within .image-container */
  bottom: 40px; /* Positions buttons below the image */
  left: 50%; /* Centers buttons */
  transform: translateX(-50%); /* Ensures perfect centering */
  display: flex; /* Aligns buttons in a row */
  justify-content: center; /* Distributes buttons evenly */
  width: 60vw; /* Responsive width */
  max-width: 400px; /* Prevents excessive stretching */
  gap: 100px; /* Adds space between buttons */
  z-index: 1000; /* Ensures buttons stay in front */
}

/* Styling for navigation button images */
.nav-buttons img {
  width: 100px; /* Sets button width */
  height: 75px; /* Sets button height */
  cursor: pointer; /* Indicates clickability */
  border-radius: 10px; /* Softens button edges */
  opacity: 0.9; /* Slight transparency */
  transition: transform 0.2s ease, opacity 0.2s ease; /* Smooth hover effect */
}

/* Button Click Effect */
.nav-buttons img:active {
  transform: scale(1.1); /* Slightly enlarges button */
  opacity: 1; /* Makes button fully visible */
}


  </style>
</head>
<body>

<!-- Fixed Header -->
<div class="header">Total Body Surface Area Burned</div>

<!-- Image and Inputs Container -->
<div class="image-container">
    <img src="https://raw.githubusercontent.com/concussed8/IOS-test/main/images/3_ref_tbsa.png" alt="Rule of 9 2year">
    
    <!-- Input Fields -->
    <input type="tel" class="input-field field1" data-max="15" value="0%" maxlength="3">
    <input type="tel" class="input-field field2" data-max="36" value="0%" maxlength="3">
    <input type="tel" class="input-field field3" data-max="N/A" value="N/A" maxlength="2">
    <input type="tel" class="input-field field4" data-max="9" value="0%" maxlength="3">
    <input type="tel" class="input-field field5" data-max="9" value="0%" maxlength="3">
    <input type="tel" class="input-field field6" data-max="15.5" value="0%" maxlength="3">
    <input type="tel" class="input-field field7" data-max="15.5" value="0%" maxlength="3">
</div>

<!-- Navigation Buttons (OUTSIDE image-container) -->
<div class="nav-buttons">
    <img src="https://raw.githubusercontent.com/concussed8/Android-App/main/images/prev.png" id="prevBtn" alt="Previous">
    <img src="https://raw.githubusercontent.com/concussed8/Android-App/main/images/next.png" id="nextBtn" alt="Next">
</div>

  <script>
// ✅ Function: Retrieve a session cookie value
function getSessionCookie(name) {
    let cookies = document.cookie.split('; ');
    for (let cookie of cookies) {
        let [cookieName, cookieValue] = cookie.split('=');
        if (cookieName === name) {
            return decodeURIComponent(cookieValue);
        }
    }
    return "";
}

// ✅ Function: Set a session cookie (1-hour expiry)
function setSessionCookie(name, value) {
    document.cookie = `${name}=${encodeURIComponent(value)}; path=/; SameSite=Lax; max-age=3600`;
}

// ✅ Function: Store input field values in "adultTBSA" cookie
function saveAdultTBSACookie() {
    let tbsaData = {};

    document.querySelectorAll(".input-field").forEach(input => {
        tbsaData[input.classList[1]] = input.value; // Store field class and value
    });

    setSessionCookie("adultTBSA", JSON.stringify(tbsaData));
}

// ✅ Function: Update background and header color based on selected burn type
function updateBackgroundColor() {
    setTimeout(() => {
        let burnType = getSessionCookie("selectedIcon") || "thermal"; // Default to thermal
        let colors = {
            "thermal": "#800000", 
            "chemical": "#90EE90", 
            "electrical": "#ADD8E6"
        };

        if (colors[burnType]) {
            document.body.style.backgroundColor = colors[burnType];
            document.querySelector(".header").style.color = colors[burnType];
        } else {
            console.warn("Unexpected burn type:", burnType);
        }
    }, 200);
}

// ✅ Function: Handle TBSA input validation
function setupTBSAInputValidation() {
    document.querySelectorAll(".input-field").forEach(input => {
        input.addEventListener("focus", function () {
            if (this.value === "0%") this.value = "";
        });

        input.addEventListener("blur", function () {
            if (this.value === "" || this.value === "%") {
                this.value = "0%";
                this.classList.remove("red-bold");
            }
        });

        input.addEventListener("input", function () {
            let value = this.value.replace(/\D/g, "");
            let maxVal = parseInt(this.dataset.max);

            if (value.length > 0) {
                if (parseInt(value) > maxVal) {
                    alert(`Value cannot exceed ${maxVal}%. Please re-enter a valid amount.`);
                    this.value = "";
                    this.classList.remove("red-bold");
                    return;
                }
                this.value = value + "%";
                this.classList.add("red-bold");
            }

            saveAdultTBSACookie();
        });

        input.addEventListener("keypress", function (e) {
            if (!/[0-9]/.test(e.key)) e.preventDefault();
        });

        input.addEventListener("keydown", function (e) {
            if (e.key === "Backspace") {
                if (this.value.length <= 2) {
                    this.value = "";
                    e.preventDefault();
                    this.classList.remove("red-bold");
                } else {
                    this.value = this.value.slice(0, -2) + "%";
                }
            }
        });

        input.addEventListener("focus", function () {
            setTimeout(() => {
                this.setSelectionRange(0, this.value.length - 1);
            }, 50);
        });
    });
}

// ✅ Function: Prevent landscape mode
function checkOrientation() {
    document.body.style.display = window.matchMedia("(orientation: landscape)").matches ? "none" : "flex";
}

// ✅ Function: Handle Next Button Navigation (Redirect Based on Age)
function setupNextButtonNavigation() {
    let nextBtn = document.getElementById("nextBtn");
    if (nextBtn) {
        nextBtn.addEventListener("click", function () {
            let age = parseInt(getSessionCookie("age"), 10);
            let nextPage = age >= 10 
                ? "https://concussed8.github.io/Android-App/pages/modified_parkland/parkland.html"
                : "https://concussed8.github.io/Android-App/pages/modified_parkland/parkland_thermal_peds.html";

            console.log("Redirecting to:", nextPage);
            window.location.href = nextPage;
        });
    }
}

// ✅ Run all functions when the page loads
document.addEventListener("DOMContentLoaded", function () {
    updateBackgroundColor();
    checkOrientation();
    setupTBSAInputValidation();
    setupNextButtonNavigation();
});

// ✅ Listen for orientation changes
window.addEventListener("resize", checkOrientation);
window.addEventListener("orientationchange", checkOrientation);
  </script>

</body>
</html>
